var errorMessages=["","Please enter a valid email address.","No account found. Please check your email and try again."],initialDisplayModel={title:"Did you forget your password?",isAcceptingEmail:!0,userInformation:"Please enter the email address below that you used to create your account and your password will be emailed to you shortly. If you have changed your email address since you first registered, you will need to re-register on our site."},workflowCompleteDisplayModel={title:"Thank you - Your password has been emailed",isAcceptingEmail:!1,userInformation:"If you do not receive your password within the next 30 minutes, please call 1 (888) 782-2224 to talk with a customer service representative."},forgotPasswordViewModel=function(){function i(t,i){var r=i.charCode||i.keyCode;return r===13?(t(),!1):(n.clearError(),!0)}function t(t){n.title(t.title.toUpperCase());n.isAcceptingEmail(t.isAcceptingEmail);n.userInformation(t.userInformation);n.clearError()}function r(){var t;document.onmousedown=function(n){t=n.target.id};document.onmouseup=function(i){(i.target.id===t||i.target.id=="forgot-password-modal")&&i.target.id==="forgot-password-modal"&&n.hideModal()}}var n=this;n.hasError=ko.observable(!1);n.errorMessage=ko.observable("");n.title=ko.observable("");n.isAcceptingEmail=ko.observable(!0);n.userInformation=ko.observable("");n.email=ko.observable("");n.displayModal=ko.observable(!1);n.canSendPasswordRequest=!0;n.closeHasFocus=ko.observable(!1);n.emailHasFocus=ko.observable(!1);n.forgotPasswordHasFocus=ko.observable(!1);n.validate=function(){var t=/^[\w\.\-]+@[a-zA-Z0-9\-]+(\.[a-zA-Z0-9\-]{1,})*(\.[a-zA-Z]{2,4}){1,2}$/.test(n.email());return(n.clearError(),n.email().length>0&&!t)?(n.setError(errorMessages[1]),n.hasError()):n.hasError()};n.setError=function(t){n.hasError(!0);n.errorMessage(t)};n.clearError=function(){n.hasError(!1);n.errorMessage("")};t(initialDisplayModel);n.showModal=function(){n.displayModal(!0);n.closeHasFocus(!1);n.forgotPasswordHasFocus(!1);n.emailHasFocus(!0)};n.hideModal=function(){n.displayModal(!1);t(initialDisplayModel);n.email("");n.emailHasFocus(!1);n.closeHasFocus(!1);n.forgotPasswordHasFocus(!0)};n.onKeyPressSendPasswordRequest=function(t,r){return i(n.sendPasswordRequest,r)};n.onKeyPressHideModal=function(t,r){return i(n.hideModal,r)};n.sendPasswordRequest=function(){if(n.validate(),!n.canSendPasswordRequest||n.hasError()){n.closeHasFocus(!1);n.forgotPasswordHasFocus(!1);n.emailHasFocus(!0);return}n.canSendPasswordRequest=!1;$.ajax("/api/shoppers/password",{type:"POST",data:{email:n.email()},success:function(i){if(i.Success){t(workflowCompleteDisplayModel);n.emailHasFocus(!1);n.forgotPasswordHasFocus(!1);n.closeHasFocus(!0);n.canSendPasswordRequest=!0;return}n.setError(errorMessages[i.EmailStatus]);n.closeHasFocus(!1);n.forgotPasswordHasFocus(!1);n.emailHasFocus(!0);n.canSendPasswordRequest=!0}})};r()}